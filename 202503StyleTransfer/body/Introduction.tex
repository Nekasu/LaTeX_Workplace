\section{Introduction}

基于神经网络的风格迁移(也即神经风格迁移)是深度学习与神经网络在艺术领域做出的尝试. 将具有艺术信息的图像与具有真实场景或人像的内容图像同时输入到网络中, 最终得到具有艺术图像艺术特征以及内容图像内容特征的风格化图像, 是风格迁移最主要的任务.
与大多数计算机视觉任务一样, 风格迁移随着神经网络的兴起而兴起. 神经风格迁移真正走入大众视野可以追溯到由 Gatys等人\cite{gatys2016image}于 2016 年 使用 VGG 中特定层作为损失函数的核心, 以图像像素作为优化对象进行的风格迁移工作. 

尽管当前工作已经从效率 \cite{huang2017arbitrary}, 质量\cite{}, 速度\cite{zhang2024artbank}, 多模态\cite{ahn2024dreamstyler}等不同方向有了广泛的发展, 但是依旧无法处理具有不透明度信息的图像. 对于一般用户而言, 不透明度通道可能可有可无, 得到一张完整的风格化图像可能可以满足他们的需求, 但是对于艺术工作者来说, 一副完整作品需要使用多种背景透明的基本元素作为点缀. 这种基本元素往往具有不规则的外形, 而图像往往是以矩形的方式保存的, 所以透明背景在基本元素中也具有重要的作用--防止遮挡其他图像.
至今大部分风格迁移工作\cite{johnson2016perceptual,risser2017stable,sanakoyeu2018style,jing2019neural,goodfellow2020generative,li2023frequency,ke2023neural,fu2023neural,tang2022few}在读入具有不透明度信息的图像时, 大多舍弃不透明度通道, 而是以三通道张量(R,G,B)的方式处理他们. 在这中情况下, 原本透明部分由于不透明度通道的丢失, 导致其变成白色或黑色色块. 这些纯色色块会被风格迁移网络误认为是图像风格的一部分, 从而导致风格化图像中存在大量不属于风格信息的色块, 最终生成难以令人满意的迁移结果.

在这份工作中, 我们提出了 \textbf{PartAlphaNet}, 一种新颖的端到端的风格迁移模型, 在能正常处理无alpha通道图像的同时, 专门考虑了具有 alpha 通道图像作为输入的情况. 为了克服传统神经风格迁移方法无法处理 alpha 通道的情况, 本文以部分卷积\cite{liu2022partial}为基础, 因为部分卷积可以很好的忽略图像中不被关心的像素. 但是传统的部分卷积依旧没有处理不透明度信息的方法, 本文为了克服这个困难, 我们使用了一种将 alpha 通道转化为数值在0~1之间的浮点掩膜的方法, 成功的将部分卷积扩展到 alpha 通道上. 基于这个方法, 我们还提出了一种浮点掩膜的自动生成手段, 以弥补部分图像不具有的 alpha 通道信息. 
同时, 由于当前风格迁移工作数据集往往以 WikiArt\cite{wikiartWikiArtorgVisual} 和 MSCOCO\cite{cocodatasetCOCOCommon} 作为基础. 这两个数据集中的图像格式基本均为 jpeg, 不包含 alpha 通道信息. 为此, 本工作以 WikiArt 与 MSCOCO 为基础, 从完整图像中拆分外形不规则且具有不透明信息的场景与风格元素, 并以 png 的格式保存, 形成了名为 AlphaImg 的数据集.
实验结果表明, 我们的方法能够很好的将 alpha 通道的信息纳入考量, 且表现优于当前的 state-of-the-art 的神经风格迁移方法. 总结来说, 我们的贡献可以被罗列如下:

\begin{itemize}
    \item 我们提出了一个名为"PartAlphaNet"的新颖网络, 可以将图像 alpha 通道信息纳入风格考量, 生成不受背景色块干扰的风格化图像. 这是通过名为 PartAlpha 的部分卷积模块实现的, 该模块以输入图像 alpha 通道信息为基础, 生成浮点掩膜. 在训练时, PartAlpha 以浮点掩膜作为权重, 参与网络训练, 以防止图像格式转换时出现的背景颜色干扰现象.
    \item 我们提出了 AlphaImg 数据集. 以 WikiArt\cite{wikiartWikiArtorgVisual} 与 MSCOCO\cite{cocodatasetCOCOCommon} 为基础, 从完整图像中裁剪并挑选了部分外形不规则的风格元素(如太阳、花朵、人物等), 并以 png 格式保存. 该数据集弥补了当前风格迁移领域较少具有不透明度信息数据集的缺陷.
    \item 我们在多种艺术风格上进行了广泛的实验, 结果表明我们的网络可以在处理多种风格的同时, 保留原图像的不透明度信息. 与当前其他方法相比, 我们的方法不会受到图片格式转换造成的风格差异现象, 取得了 state-of-art 的成绩.
\end{itemize}